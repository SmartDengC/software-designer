
# 0x00 操作系统章节概述
操作系统 管理资源啊
1、操作系统相关概念，操作系统的功能、特殊的操作系统
2、进程管理 多
- 进程的概念，进程的状态、进程的调度、pv操作的相关概念
- 信号量与pv操作
- 前驱图和pv操作
- 死锁的管理（死锁的四大条件、资源数计算、银行家算法）
- 进程资源图
3、存储管理
- 段式存储，页式存储，段页式存储
4、设备管理
- I/O管理软件分层
5、文件管理
- 树形目录结构
- 索引文件结构
- 位市图
6、作业管理
- 作业状态，调度




# 0x01 操作系统概念
## 00 操作系统概念概述


## 01 操作系统的作用

操作系统是硬件之上的第一层软件。
计算机硬件 -- 操作系统 -- 语言处理程序 -- 应用程序

- 管理系统的硬件、软件、数据资源
- 控制程序运行
- 人机之间的接口
- 应用软件与硬件之间的接口

## 10 特殊的操作系统

- 批处理操作系统（单道批，多道批）
- 分时操作系统（时间片轮转）
- 实时操作系统（及时性，在规定时间内响应）  √
- 网络操作系统（共享资源）
- 分布式操作系统
- 微机操作系统（win， linux）
- 嵌入式操作系统（运行在智能芯片环境中；微型化、可定制、实时性、可靠性、易移植行））√

### 问：
1、从减少成本和缩短研发周期考虑，要求嵌入式操作系统能运行在不同的微处理器平台上，能针对硬件变化进行结构与功能上的配置。该要求体现了嵌入式操作系统的（—）。  可定制性

# 0x02 进程的概念

## 00 进程的概念概述
## 01 线程的概念
进程是程序在一个数据集合上运行的过程，他是系统进行资源分配和调度的一个独立单位。它由程序块、进程控制块pcb和数据块三部分组成。

pcb：是进程存在的唯一标识。内容包含进程标识符、状态、位置信息、控制信息、队列指针、优先级、现场保护区。

进程与程序的区别：进程是程序的一次执行过程，没有程序也就没有进程。
程序是一个静态的概念，而进程是一个动态的概念，它有创建而产生，完成任务后因撤销而消亡；进程是系统进行资源分配和调度的独立单位，而程序不是

### 1 进程与线程
进程的2个基本属性：1可拥有资源的独立单位，2可独立调度和分配资源的基本单位。

在进程中可以拥有多个线程。线程之间共享的有内存空间、代码、数据、文件等，程序计数器、寄存器、栈是线程特有的，不具有共享的特性。

## 10 进程的状态
三态模型
运行，当一个进程在cpu上运行时
就绪，一个进程获得了除cpu外的一切所需要的资源，一旦得到cpu资源就可以运行
等待：阻塞也称睡眠状态，一个进程正在等待某一时间发生而停止运行，此时即使把cpu分给进程也无法运行。

运行状态可以以为时间片用完了，而转换到就绪状态，也可以因为其他等待到达阻塞状态。
就绪状态获得cpu资源而进入运行状态。
阻塞状态获取某些资源进入就绪状态。

五态模式：
挂起：

# 0x03 进程调度

## 00 PV操作的概念
进程的同步与互斥
互斥如千军万马过独木桥（独木桥为临界资源）
临界资源：进程之间需要互斥方式对其进行共享的资源（进程中访问临界资源的那段代码称为临界区）， 间接制约。

同步：速度有差异，在一定情况停下等待，直接制约关系。

pv控制程序。
p操作，要么都做要么都不做

信号量是一种特殊的变量，信号量可以表示资源数量，信号量为负数时还可以表示排队进程数。

p 操作申请资源
s 释放资源

### 问：
1、pv操作是操作系统提供的具有特定功能的原语。利用pv操作可以（B）？
- A 保证系统不发生死锁（加锁解锁的过程会出现）
- B 实现资源的互斥使用
- C 提高资源的利用率
- D 推迟进程使用共享资源的时间
2、假设系统中有n个进程共享3台扫描仪，并采用pv操作实现进行同步与互斥。若系统信号量s的当前值为-1，进程p1、p2又分别执行了1次p(s)操作，那么信号量s的值应该是 （B）s= -1 -1-1 = -3
- A 3
- B -3
- C 1
- D -1



## 01 信号量与PV操作



## 10 前趋图和PV操作



# 0x04 死锁资源数计算

什么是死锁：是指两个以上的进程互相都需要对方已占有的资源导致无法继续运行下去的想象

死锁的四大条件
- 资源互斥
- 保持和等待（拥有资源，没有就一直等待获取）
- 不剥夺 
- 环路等待

死锁处理
死锁的预防 1、有序资源分配，
死锁的避免  银行家算法
死锁的检测与解除
鸵鸟策略（不予理睬）

系统不可能发生死锁的最小资源数 (w-1) * m+1 <= n

问：系统有5个进程，a,b,c,d,e这5个进程都需要4个系统资源，如果系统资源至少有多少个，则不可能发生死锁  

2、某计算机系统中互斥资源R的可用数为8，系统中有3个进程竞争R，且每个进程都需要i个R，该系统可能会发生死锁的最小i值是多少（D） 就是带入公式计算i值
- A 1
- B 2
- C 3
- D 4
# 0x06 进程资源图

obsidian 里面画图
进程p， 资源R1
资源指向进程，表示资源已经分配给进程
进程指向资源，表示进程申请资源

可化简， 非阻塞节点（非死锁）
阻塞和非阻塞表示当前情况下节点是否可以运行，阻塞节点后序可以得到资源运行
可化简 表示图里面节点可以，表示非死锁

# Ox07 段页式存储

## 00、页式存储 常考
页式存储：将程序与内存均划分为同样大小的快，以页为单位将程序调入内存。
用户程序  -- 页表 -- 内存（页帧号）
页表用来存用户程序页和内存之间的对应
逻辑地址 = 页号 + 页内地址
物理地址 = 页帧号+页内地址

优点：利用率高，碎片小，分配管理简单
缺点：增加了系统开销，可能产生抖动现象

缺页中断
1、访问位为0， 状态位为1的话表示，刚才访问了
2、如果有多个状态位为0的，淘汰状态位为0的（为1的有修改文件，淘汰的话修改大）

- 最优算法 OPT
- 最近最少用 LRU
- 先进先出 FIFO

## 01、段式存储 不多
为什么会有段式存储？
页式存储可能将存续的一部分存到上一页，一些存放到下一页，例如for循环，条件和条件体分开

什么是段式存储？
段式存储：按用户作业中的自然段来划分逻辑空间，然后调入内存，段的长度可以不一样

段基址
段长
段表

段的逻辑地址  段号、段内偏移量
段内偏移量不能超过段长 判断是否合理。‘

优点：多程序共享内存，隔断程序修改互不影响
缺点：

## 10、段页式存储 

段页式存储就是利用页式存储和顿时存储的优点

段页式存储：段式和页式的综合体。先分段，然后在分页。一个程序有若干个段，每个段中可以有拖杆也·若干页，每个页的大小相同，但是每个段的大小不同

段号--页号--页内地址

# 0x08 磁盘管理

磁盘管理

磁道， 扇区，柱面， 0磁道

存取时间 = 巡道时间 + 移动时间

问：某磁盘磁头从一个磁道到另一个磁道需要10ms。文件在磁道上是非连续存放，逻辑上相邻数据块的平均移动时间为10个磁道，每块旋转延迟时间和传输时间分别为100ms和2ms，则读取一个100块的文件需要（）ms时间
（10 *  10 + 200 + 2）* 100

先来先服务  FCFS
最短寻到时间优先  SSTF
扫描算法 SCAN  电梯算法，双向
循环扫描算法 CSCAN 单向


# 0x09 IO管理软件
管理软件分层

从底向上
硬件，完成具体的io操作
中断处理程序、io完成后唤醒设备驱动程序
设备驱动程序、设置寄存器、检查设备状态
设备无关程序、设备名接续，阻塞进程，分配缓冲区
用户进程：发出io调用

掌握：1 分层  2 作用
#  0x10 文件管理

## 1、文件相关概念
文件：具有符号名，在逻辑上具有完整意义的一组相关信息项的集合。
逻辑结构：有结构的记录式文件、无结构的流式文件

物理结构：连续结构、链接结构、索引结构、多个物理块的索引表

文件目录项、文件的说明、文件控制块pcb
基本信息类：文件名、文件的物理地址、文件的长度和文件块数、
存储控制信息类：文件的存储权限，读写、执行权限
文件属性：只执行、只读等等

目录结构
一级目录结构
二级目录结构
三级目录结构：树型目录结构（多级目录结构）

## 2、树形目录结构

## 3、位示图

空闲存储空间的管理

问：
某字长32为的计算机的文件管理系统采用位示图记录磁盘使用情况，若磁盘的容量为300GB，物理块的大小为1MB，那么位示图的大小为（）字。

一个字有32个bitmap， 求磁盘有多少块：使用总容量 除以每块的大小
300GB/ 1MB * 32

## 4、索引文件
索引的结构

直接索引 只索引一次 0-9
一级间接索引  341
二级间接索引 341 * 341
三级间接索引 

1 逻辑页号， 对应索引方式， 访问磁盘次数
2 最大的文件长度

# 0x11 作业管理
作业调度算
- 先来先服务
- 时间片轮转
- 短作业优先
- 最高优先权优先
- 高响应比优先（相应比= （作业等待时间+作业执行时间）/ 作业执行时间）

# 0x12 操作系统回顾



